<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Query Manager Demo</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .demo-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        button {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover {
            background: #2980b9;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            background: #e8f4f8;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <h1>üóÇÔ∏è AI Query Manager Demo</h1>
        <p>This demo shows the query manager with sample data.</p>
        
        <button onclick="addSampleQueries()">Add Sample Queries</button>
        <button onclick="openManager()">Open Query Manager</button>
        <button onclick="clearAll()">Clear All</button>
        
        <div id="result" class="result"></div>
    </div>
    
    <script type="module">
        import { initDB, storeQuery, getAllQueries, clearAllQueries } from './src/indexedDB.js';
        
        await initDB();
        
        window.addSampleQueries = async function() {
            const resultDiv = document.getElementById('result');
            resultDiv.textContent = 'Adding sample queries...';
            
            try {
                // Add multiple sample queries
                await storeQuery(
                    'demo-doc-001',
                    'What violations were found in this report?',
                    'The report found one violation: Rule 400.14310 regarding medication administration procedures. Specifically, a staff member administered medication without proper documentation.',
                    250,
                    75,
                    2500,
                    0.002
                );
                
                await storeQuery(
                    'demo-doc-001',
                    'What corrective actions are required?',
                    'The facility must complete three corrective actions within 30 days: 1) Update medication administration logs, 2) Provide additional staff training on medication protocols, and 3) Submit revised procedures for review.',
                    220,
                    65,
                    2100,
                    0.0018
                );
                
                await storeQuery(
                    'demo-doc-002',
                    'Is the facility in compliance?',
                    'The facility is partially in compliance. It meets requirements for Rules 400.14305, 400.14306, and 400.14308, but is NOT in compliance with Rule 400.14310.',
                    200,
                    55,
                    1800,
                    0.0015
                );
                
                await storeQuery(
                    'demo-doc-003',
                    'Summarize the key findings of this investigation.',
                    'This special investigation report examined allegations of licensing rule violations at a children\'s facility. The investigation confirmed proper adherence to staff qualifications, background checks, and supervision ratios. However, a violation was established for medication administration procedures due to inadequate documentation.',
                    300,
                    95,
                    3200,
                    0.0025
                );
                
                const queries = await getAllQueries();
                resultDiv.innerHTML = `<strong>‚úì Success!</strong> Added 4 sample queries. Total queries in database: ${queries.length}`;
                
            } catch (error) {
                resultDiv.innerHTML = `<strong>‚úó Error:</strong> ${error.message}`;
            }
        };
        
        window.openManager = function() {
            window.location.href = '/?openManager=true';
        };
        
        window.clearAll = async function() {
            const resultDiv = document.getElementById('result');
            try {
                await clearAllQueries();
                const queries = await getAllQueries();
                resultDiv.innerHTML = `<strong>‚úì Cleared!</strong> Total queries: ${queries.length}`;
            } catch (error) {
                resultDiv.innerHTML = `<strong>‚úó Error:</strong> ${error.message}`;
            }
        };
        
        // Show current count
        (async () => {
            const queries = await getAllQueries();
            document.getElementById('result').innerHTML = `Current queries in database: ${queries.length}`;
        })();
    </script>
</body>
</html>
